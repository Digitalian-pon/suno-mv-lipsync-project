<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ğŸµ AI Complete Music Creator | AIå®Œå…¨éŸ³æ¥½ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        body {
            font-family: 'Segoe UI', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea, #764ba2);
            min-height: 100vh;
            padding: 15px;
        }
        
        .container {
            max-width: 600px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 20px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            background: linear-gradient(135deg, #667eea, #764ba2);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            margin-bottom: 20px;
            font-size: 2em;
        }
        
        .subtitle {
            text-align: center;
            color: #764ba2;
            font-size: 1.2em;
            margin-top: -15px;
            margin-bottom: 20px;
        }
        
        .section {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 20px;
        }
        
        .section h3 {
            color: #667eea;
            margin-bottom: 15px;
        }
        
        .btn {
            width: 100%;
            padding: 15px;
            margin: 10px 0;
            border: none;
            border-radius: 25px;
            font-size: 16px;
            font-weight: bold;
            cursor: pointer;
            background: linear-gradient(135deg, #667eea, #764ba2);
            color: white;
            -webkit-tap-highlight-color: transparent;
        }
        
        .btn:active {
            transform: scale(0.98);
        }
        
        .btn:disabled {
            background: #999;
            cursor: not-allowed;
        }
        
        .btn-secondary {
            background: linear-gradient(135deg, #28a745, #20c997);
        }
        
        .btn-danger {
            background: linear-gradient(135deg, #dc3545, #c82333);
        }
        
        .btn-warning {
            background: linear-gradient(135deg, #ffc107, #e0a800);
        }
        
        .api-key-area {
            width: 100%;
            min-height: 60px;
            padding: 15px;
            border: 2px solid #ddd;
            border-radius: 10px;
            font-family: monospace;
            font-size: 14px;
            background: white;
            color: #333;
            overflow-wrap: break-word;
            word-break: break-all;
            outline: none;
        }
        
        .api-key-area:focus {
            border-color: #667eea;
            background: #fafafa;
        }
        
        .api-key-area[contenteditable="true"]:empty:before {
            content: "ã“ã“ã‚’ã‚¿ãƒƒãƒ—ã—ã¦APIã‚­ãƒ¼ã‚’å…¥åŠ›";
            color: #999;
        }
        
        .status {
            padding: 10px;
            border-radius: 8px;
            margin: 10px 0;
            text-align: center;
            font-weight: bold;
        }
        
        .status.success {
            background: #d4edda;
            color: #155724;
        }
        
        .status.error {
            background: #f8d7da;
            color: #721c24;
        }
        
        .status.warning {
            background: #fff3cd;
            color: #856404;
        }
        
        .help-text {
            background: #e7f3ff;
            border-left: 4px solid #2196F3;
            padding: 15px;
            margin: 15px 0;
            font-size: 14px;
            line-height: 1.5;
        }
        
        .theme-display {
            background: white;
            border: 2px solid #667eea;
            border-radius: 10px;
            padding: 20px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #667eea;
            margin: 15px 0;
        }
        
        .result-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 15px;
            margin: 15px 0;
        }
        
        .result-header {
            font-weight: bold;
            color: #667eea;
            margin-bottom: 10px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .result-content {
            white-space: pre-wrap;
            line-height: 1.6;
            max-height: 300px;
            overflow-y: auto;
            background: white;
            padding: 10px;
            border-radius: 5px;
            font-size: 14px;
        }
        
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 14px;
        }
        
        .api-method-buttons {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .method-btn {
            flex: 1;
            padding: 12px;
            border: 2px solid #ddd;
            border-radius: 10px;
            background: white;
            cursor: pointer;
            text-align: center;
            font-size: 14px;
            transition: all 0.3s;
        }
        
        .method-btn:hover {
            border-color: #667eea;
            background: #f0f4ff;
        }
        
        .method-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
            align-items: center;
        }
        
        .controls label {
            font-weight: bold;
            color: #667eea;
        }
        
        .controls select {
            padding: 8px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
            background: white;
        }
        
        .controls select:focus {
            border-color: #667eea;
            outline: none;
        }
        
        .model-select {
            margin: 10px 0;
            padding: 10px;
            background: #f0f4ff;
            border-radius: 8px;
        }
        
        .model-select label {
            color: #667eea;
            font-weight: bold;
            font-size: 14px;
        }
        
        .model-select select {
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border: 2px solid #ddd;
            border-radius: 8px;
            font-size: 14px;
        }
        
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ AI Complete Creator<br><span style="font-size: 0.6em; color: #764ba2;">AIå®Œå…¨éŸ³æ¥½ã‚¯ãƒªã‚¨ã‚¤ã‚¿ãƒ¼</span></h1>
        <div style="text-align: center; color: #666; margin-bottom: 20px;">
            Claude & Gemini AI æ¥½æ›²ã‚¸ã‚§ãƒãƒ¬ãƒ¼ã‚¿ãƒ¼ï¼ˆå®Œå…¨AIç”Ÿæˆç‰ˆï¼‰
        </div>
        
        <!-- APIé¸æŠ -->
        <div class="section" style="background: linear-gradient(135deg, #FFE5EC, #E5E5FF);">
            <h3>ğŸ¤– AI APIé¸æŠ</h3>
            <div style="display: flex; gap: 10px; justify-content: center; margin: 15px 0;">
                <button class="method-btn active" id="apiClaude" onclick="selectAPI('claude')" style="flex: 1; max-width: 200px;">
                    ğŸ­ Claude API
                </button>
                <button class="method-btn" id="apiGemini" onclick="selectAPI('gemini')" style="flex: 1; max-width: 200px;">
                    ğŸ’ Gemini API
                </button>
            </div>
            
            <!-- Geminiãƒ¢ãƒ‡ãƒ«é¸æŠ -->
            <div class="model-select" id="geminiModelSelect" style="display: none;">
                <label>ğŸ’ Geminiãƒ¢ãƒ‡ãƒ«:</label>
                <select id="geminiModel" onchange="updateGeminiModel()">
                    <option value="gemini-2.0-flash-exp">Gemini 2.0 Flash (Experimental) - æœ€æ–°</option>
                    <option value="gemini-1.5-flash">Gemini 1.5 Flash - é«˜é€Ÿ</option>
                    <option value="gemini-1.5-flash-8b">Gemini 1.5 Flash 8B - è»½é‡</option>
                    <option value="gemini-1.5-pro">Gemini 1.5 Pro - é«˜æ€§èƒ½</option>
                </select>
            </div>
        </div>
        
        <!-- APIè¨­å®šã‚»ã‚¯ã‚·ãƒ§ãƒ³ -->
        <div class="section" id="apiSection">
            <h3 id="apiTitle">ğŸ­ Claude APIè¨­å®š</h3>
            
            <div class="help-text">
                <strong>ğŸ“± APIã‚­ãƒ¼å…¥åŠ›æ–¹æ³•ï¼š</strong>
            </div>
            
            <div class="api-method-buttons">
                <button class="method-btn active" id="method1" onclick="selectMethod(1)">
                    ãƒ€ã‚¤ã‚¢ãƒ­ã‚°å…¥åŠ›
                </button>
                <button class="method-btn" id="method2" onclick="selectMethod(2)">
                    ç›´æ¥å…¥åŠ›
                </button>
            </div>
            
            <!-- æ–¹æ³•1: ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆãƒ€ã‚¤ã‚¢ãƒ­ã‚° -->
            <div id="method1Content" style="display: block;">
                <button class="btn btn-warning" onclick="promptForApiKey()">
                    ğŸ“ APIã‚­ãƒ¼ã‚’å…¥åŠ›ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰
                </button>
                <div id="promptResult" style="margin-top: 10px; font-family: monospace; font-size: 12px; color: #666;"></div>
            </div>
            
            <!-- æ–¹æ³•2: ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ç·¨é›†å¯èƒ½div -->
            <div id="method2Content" style="display: none;">
                <div class="help-text" style="background: #fff3cd; border-color: #ffc107;">
                    ä¸‹ã®æ å†…ã‚’ã‚¿ãƒƒãƒ—ã—ã¦ã€APIã‚­ãƒ¼ã‚’ç›´æ¥å…¥åŠ›ã¾ãŸã¯è²¼ã‚Šä»˜ã‘ã¦ãã ã•ã„
                </div>
                <div 
                    id="apiKeyDiv" 
                    class="api-key-area"
                    contenteditable="true"
                    spellcheck="false"
                    autocomplete="off"
                    autocorrect="off"
                    autocapitalize="off"
                    oninput="onApiKeyDivChange()"
                ></div>
                <div id="divCharCount" style="text-align: right; font-size: 12px; color: #666; margin-top: 5px;">0æ–‡å­—</div>
            </div>
            
            <!-- å…±é€šãƒœã‚¿ãƒ³ -->
            <button class="btn" onclick="testConnection()" id="testBtn">
                ğŸ”Œ æ¥ç¶šãƒ†ã‚¹ãƒˆ
            </button>
            
            <button class="btn btn-danger" onclick="clearApiKey()">
                ğŸ—‘ï¸ APIã‚­ãƒ¼ã‚¯ãƒªã‚¢
            </button>
            
            <div id="apiStatus"></div>
        </div>
        
        <!-- ãƒ†ãƒ¼ãƒç”Ÿæˆ -->
        <div class="section">
            <h3>ğŸ¯ æ¥½æ›²ãƒ†ãƒ¼ãƒï¼ˆå®Œå…¨AIç”Ÿæˆï¼‰</h3>
            
            <!-- è¨€èªåˆ‡ã‚Šæ›¿ãˆ -->
            <div style="display: flex; gap: 10px; margin-bottom: 15px; justify-content: center;">
                <button class="method-btn active" id="langJa" onclick="switchLanguage('ja')" style="width: 100px;">
                    ğŸ‡¯ğŸ‡µ æ—¥æœ¬èª
                </button>
                <button class="method-btn" id="langEn" onclick="switchLanguage('en')" style="width: 100px;">
                    ğŸ‡ºğŸ‡¸ English
                </button>
            </div>
            
            <!-- ã‚«ãƒ†ã‚´ãƒªãƒ¼é¸æŠï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰ -->
            <div style="margin-bottom: 15px;">
                <label style="color: #667eea; font-weight: bold;">ãƒ†ãƒ¼ãƒã‚«ãƒ†ã‚´ãƒªãƒ¼ï¼ˆã‚ªãƒ—ã‚·ãƒ§ãƒ³ï¼‰:</label>
                <select id="themeCategory" style="width: 100%; padding: 8px; border: 2px solid #ddd; border-radius: 8px; margin-top: 5px;">
                    <option value="random">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆAIã«ãŠä»»ã›ï¼‰</option>
                    <option value="romance">ğŸ’• æ‹æ„›ãƒ»ãƒ­ãƒãƒ³ã‚¹</option>
                    <option value="friendship">ğŸ¤ å‹æƒ…ãƒ»çµ†</option>
                    <option value="dream">ğŸŒŸ å¤¢ãƒ»æŒ‘æˆ¦</option>
                    <option value="daily">â˜€ï¸ æ—¥å¸¸ãƒ»ç”Ÿæ´»</option>
                    <option value="digital">ğŸ’» ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼</option>
                    <option value="fantasy">ğŸ¦„ ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ãƒ»SF</option>
                    <option value="dark">ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ»ã‚·ãƒªã‚¢ã‚¹</option>
                    <option value="nostalgia">ğŸ“¼ ãƒã‚¹ã‚¿ãƒ«ã‚¸ãƒ¼ãƒ»ãƒ¬ãƒˆãƒ­</option>
                    <option value="adventure">ğŸ”ï¸ å†’é™ºãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</option>
                    <option value="mystery">ğŸ” ãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒ»ã‚µã‚¹ãƒšãƒ³ã‚¹</option>
                    <option value="comedy">ğŸ˜„ ã‚³ãƒ¡ãƒ‡ã‚£ãƒ»ãƒ¦ãƒ¼ãƒ¢ã‚¢</option>
                    <option value="sports">âš½ ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç«¶æŠ€</option>
                    <option value="art">ğŸ¨ éŸ³æ¥½ãƒ»ã‚¢ãƒ¼ãƒˆ</option>
                    <option value="school">ğŸ“ å­¦åœ’ãƒ»ã‚¹ã‚¯ãƒ¼ãƒ«</option>
                    <option value="work">ğŸ’¼ ä»•äº‹ãƒ»ãƒ“ã‚¸ãƒã‚¹</option>
                    <option value="travel">âœˆï¸ æ—…è¡Œãƒ»è¦³å…‰</option>
                    <option value="food">ğŸœ é£Ÿã¹ç‰©ãƒ»ã‚°ãƒ«ãƒ¡</option>
                    <option value="pet">ğŸ• ãƒšãƒƒãƒˆãƒ»å‹•ç‰©</option>
                    <option value="nature">ğŸŒ¿ è‡ªç„¶ãƒ»é¢¨æ™¯</option>
                </select>
            </div>
            
            <!-- ãƒ†ãƒ¼ãƒç”Ÿæˆãƒœã‚¿ãƒ³ -->
            <button class="btn btn-secondary" onclick="generateAITheme()" id="aiThemeBtn">
                ğŸ¤– AIãƒ†ãƒ¼ãƒç”Ÿæˆï¼ˆå®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«ï¼‰
            </button>
            
            <!-- ãƒ†ãƒ¼ãƒè¡¨ç¤ºã‚¨ãƒªã‚¢ï¼ˆç·¨é›†å¯èƒ½ï¼‰ -->
            <div class="theme-display" id="themeDisplay" contenteditable="true" style="cursor: text;">
                ãƒ†ãƒ¼ãƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„
            </div>
            <div style="text-align: center; margin-top: 5px; color: #666; font-size: 12px;">
                âœï¸ ã‚¯ãƒªãƒƒã‚¯ã—ã¦ç·¨é›†å¯èƒ½
            </div>
        </div>
        
        <!-- æ¥½æ›²ç”Ÿæˆ -->
        <div class="section">
            <button class="btn" onclick="generateSong()" id="generateBtn" disabled>
                ğŸš€ 3åˆ†æ¥½æ›²ã‚’ç”Ÿæˆï¼ˆè¦APIæ¥ç¶šï¼‰
            </button>
        </div>
        
        <!-- çµæœè¡¨ç¤º -->
        <div id="results"></div>
    </div>
    
    <script>
        // ã‚°ãƒ­ãƒ¼ãƒãƒ«å¤‰æ•°
        let apiKey = '';
        let apiConnected = false;
        let currentTheme = '';
        let isGenerating = false;
        let selectedMethod = 1;
        let currentData = {};
        let selectedAPI = 'claude';
        let currentLanguage = 'ja';
        let geminiModel = 'gemini-2.0-flash-exp';
        let generatedThemes = [];
        
        // åˆæœŸåŒ–
        window.onload = function() {
            const savedClaude = localStorage.getItem('claudeApiKey');
            const savedGemini = localStorage.getItem('geminiApiKey');
            
            if (savedClaude) {
                selectedAPI = 'claude';
                apiKey = savedClaude;
                displayApiKey();
                setTimeout(() => testConnection(), 1000);
            } else if (savedGemini) {
                selectedAPI = 'gemini';
                selectAPI('gemini');
                apiKey = savedGemini;
                displayApiKey();
                setTimeout(() => testConnection(), 1000);
            }
            
            // ãƒ†ãƒ¼ãƒç·¨é›†æ©Ÿèƒ½ã®åˆæœŸåŒ–
            const themeDisplay = document.getElementById('themeDisplay');
            if (themeDisplay) {
                themeDisplay.addEventListener('input', function() {
                    currentTheme = this.textContent.replace(/^[ğŸ”¥ğŸ²]\\s*/, '');
                });
                
                themeDisplay.addEventListener('focus', function() {
                    if (this.textContent === 'ãƒ†ãƒ¼ãƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„') {
                        this.textContent = '';
                    }
                });
                
                themeDisplay.addEventListener('blur', function() {
                    if (this.textContent === '') {
                        this.textContent = 'ãƒ†ãƒ¼ãƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„';
                    }
                });
            }
        };
        
        // APIé¸æŠ
        function selectAPI(api) {
            selectedAPI = api;
            document.getElementById('apiClaude').classList.remove('active');
            document.getElementById('apiGemini').classList.remove('active');
            document.getElementById('api' + api.charAt(0).toUpperCase() + api.slice(1)).classList.add('active');
            
            const apiTitle = document.getElementById('apiTitle');
            const geminiModelSelect = document.getElementById('geminiModelSelect');
            
            if (api === 'claude') {
                apiTitle.innerHTML = 'ğŸ­ Claude APIè¨­å®š';
                apiKey = localStorage.getItem('claudeApiKey') || '';
                if (geminiModelSelect) geminiModelSelect.style.display = 'none';
            } else {
                apiTitle.innerHTML = 'ğŸ’ Gemini APIè¨­å®š';
                apiKey = localStorage.getItem('geminiApiKey') || '';
                if (geminiModelSelect) geminiModelSelect.style.display = 'block';
            }
            
            displayApiKey();
            apiConnected = false;
            document.getElementById('generateBtn').disabled = true;
            document.getElementById('apiStatus').innerHTML = '';
        }
        
        // Geminiãƒ¢ãƒ‡ãƒ«æ›´æ–°
        function updateGeminiModel() {
            geminiModel = document.getElementById('geminiModel').value;
            console.log('Gemini model updated to:', geminiModel);
        }
        
        // è¨€èªåˆ‡ã‚Šæ›¿ãˆ
        function switchLanguage(lang) {
            currentLanguage = lang;
            document.getElementById('langJa').classList.toggle('active', lang === 'ja');
            document.getElementById('langEn').classList.toggle('active', lang === 'en');
            
            const categorySelect = document.getElementById('themeCategory');
            if (lang === 'en') {
                categorySelect.innerHTML = `
                    <option value="random">ğŸ² Random (AI Choice)</option>
                    <option value="romance">ğŸ’• Romance</option>
                    <option value="friendship">ğŸ¤ Friendship</option>
                    <option value="dream">ğŸŒŸ Dreams & Ambitions</option>
                    <option value="daily">â˜€ï¸ Daily Life</option>
                    <option value="digital">ğŸ’» Digital & Tech</option>
                    <option value="fantasy">ğŸ¦„ Fantasy & Sci-Fi</option>
                    <option value="dark">ğŸŒ™ Dark & Serious</option>
                    <option value="nostalgia">ğŸ“¼ Nostalgia & Retro</option>
                    <option value="adventure">ğŸ”ï¸ Adventure & Action</option>
                    <option value="mystery">ğŸ” Mystery & Suspense</option>
                    <option value="comedy">ğŸ˜„ Comedy & Humor</option>
                    <option value="sports">âš½ Sports</option>
                    <option value="art">ğŸ¨ Music & Art</option>
                    <option value="school">ğŸ“ School Life</option>
                    <option value="work">ğŸ’¼ Work & Business</option>
                    <option value="travel">âœˆï¸ Travel</option>
                    <option value="food">ğŸœ Food & Cuisine</option>
                    <option value="pet">ğŸ• Pets & Animals</option>
                    <option value="nature">ğŸŒ¿ Nature & Landscape</option>
                `;
            } else {
                categorySelect.innerHTML = `
                    <option value="random">ğŸ² ãƒ©ãƒ³ãƒ€ãƒ ï¼ˆAIã«ãŠä»»ã›ï¼‰</option>
                    <option value="romance">ğŸ’• æ‹æ„›ãƒ»ãƒ­ãƒãƒ³ã‚¹</option>
                    <option value="friendship">ğŸ¤ å‹æƒ…ãƒ»çµ†</option>
                    <option value="dream">ğŸŒŸ å¤¢ãƒ»æŒ‘æˆ¦</option>
                    <option value="daily">â˜€ï¸ æ—¥å¸¸ãƒ»ç”Ÿæ´»</option>
                    <option value="digital">ğŸ’» ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼</option>
                    <option value="fantasy">ğŸ¦„ ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ãƒ»SF</option>
                    <option value="dark">ğŸŒ™ ãƒ€ãƒ¼ã‚¯ãƒ»ã‚·ãƒªã‚¢ã‚¹</option>
                    <option value="nostalgia">ğŸ“¼ ãƒã‚¹ã‚¿ãƒ«ã‚¸ãƒ¼ãƒ»ãƒ¬ãƒˆãƒ­</option>
                    <option value="adventure">ğŸ”ï¸ å†’é™ºãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³</option>
                    <option value="mystery">ğŸ” ãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒ»ã‚µã‚¹ãƒšãƒ³ã‚¹</option>
                    <option value="comedy">ğŸ˜„ ã‚³ãƒ¡ãƒ‡ã‚£ãƒ»ãƒ¦ãƒ¼ãƒ¢ã‚¢</option>
                    <option value="sports">âš½ ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç«¶æŠ€</option>
                    <option value="art">ğŸ¨ éŸ³æ¥½ãƒ»ã‚¢ãƒ¼ãƒˆ</option>
                    <option value="school">ğŸ“ å­¦åœ’ãƒ»ã‚¹ã‚¯ãƒ¼ãƒ«</option>
                    <option value="work">ğŸ’¼ ä»•äº‹ãƒ»ãƒ“ã‚¸ãƒã‚¹</option>
                    <option value="travel">âœˆï¸ æ—…è¡Œãƒ»è¦³å…‰</option>
                    <option value="food">ğŸœ é£Ÿã¹ç‰©ãƒ»ã‚°ãƒ«ãƒ¡</option>
                    <option value="pet">ğŸ• ãƒšãƒƒãƒˆãƒ»å‹•ç‰©</option>
                    <option value="nature">ğŸŒ¿ è‡ªç„¶ãƒ»é¢¨æ™¯</option>
                `;
            }
        }
        
        // å…¥åŠ›æ–¹æ³•é¸æŠ
        function selectMethod(method) {
            selectedMethod = method;
            
            document.querySelectorAll('.method-btn').forEach(btn => {
                if (btn.id.startsWith('method')) {
                    btn.classList.remove('active');
                }
            });
            document.getElementById('method' + method).classList.add('active');
            
            document.getElementById('method1Content').style.display = method === 1 ? 'block' : 'none';
            document.getElementById('method2Content').style.display = method === 2 ? 'block' : 'none';
        }
        
        // APIã‚­ãƒ¼å…¥åŠ›ï¼ˆãƒ€ã‚¤ã‚¢ãƒ­ã‚°ï¼‰
        function promptForApiKey() {
            const apiName = selectedAPI === 'claude' ? 'Claude' : 'Gemini';
            const format = selectedAPI === 'claude' ? 'sk-ant-api...ã§å§‹ã¾ã‚‹100æ–‡å­—ç¨‹åº¦' : 'AIzaSy...ã§å§‹ã¾ã‚‹40æ–‡å­—ç¨‹åº¦';
            
            const input = prompt(`${apiName} APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„ï¼ˆ${format}ï¼‰:`);
            if (input && input.trim()) {
                apiKey = input.trim();
                localStorage.setItem(selectedAPI + 'ApiKey', apiKey);
                displayApiKey();
                document.getElementById('apiStatus').innerHTML = '<div class="status warning">APIã‚­ãƒ¼ã‚’ä¿å­˜ã—ã¾ã—ãŸã€‚æ¥ç¶šãƒ†ã‚¹ãƒˆã‚’å®Ÿè¡Œã—ã¦ãã ã•ã„ã€‚</div>';
            }
        }
        
        // APIã‚­ãƒ¼å…¥åŠ›å¤‰æ›´æ™‚
        function onApiKeyDivChange() {
            const div = document.getElementById('apiKeyDiv');
            const text = div.textContent || div.innerText || '';
            const count = document.getElementById('divCharCount');
            
            count.textContent = text.length + 'æ–‡å­—';
            
            const isValid = (selectedAPI === 'claude' && text.startsWith('sk-ant-api') && text.length >= 100) ||
                           (selectedAPI === 'gemini' && text.startsWith('AIzaSy') && text.length >= 39);
            
            if (isValid) {
                apiKey = text.trim();
                localStorage.setItem(selectedAPI + 'ApiKey', apiKey);
                count.innerHTML = text.length + 'æ–‡å­— <span style="color: green;">âœ…</span>';
            } else if (text.length > 0) {
                count.innerHTML = text.length + 'æ–‡å­— <span style="color: orange;">âš ï¸</span>';
            }
        }
        
        // APIã‚­ãƒ¼è¡¨ç¤º
        function displayApiKey() {
            if (apiKey) {
                const masked = apiKey.substring(0, 10) + '...' + apiKey.substring(apiKey.length - 5);
                document.getElementById('promptResult').textContent = 'APIã‚­ãƒ¼: ' + masked;
                document.getElementById('apiKeyDiv').textContent = apiKey;
                onApiKeyDivChange();
            }
        }
        
        // APIã‚­ãƒ¼ã‚¯ãƒªã‚¢
        function clearApiKey() {
            if (confirm('APIã‚­ãƒ¼ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã™ã‹ï¼Ÿ')) {
                apiKey = '';
                localStorage.removeItem(selectedAPI + 'ApiKey');
                apiConnected = false;
                document.getElementById('generateBtn').disabled = true;
                document.getElementById('apiStatus').innerHTML = '';
                document.getElementById('promptResult').textContent = '';
                document.getElementById('apiKeyDiv').textContent = '';
                document.getElementById('divCharCount').textContent = '0æ–‡å­—';
                alert('APIã‚­ãƒ¼ã‚’ã‚¯ãƒªã‚¢ã—ã¾ã—ãŸ');
            }
        }
        
        // APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
        async function testConnection() {
            const status = document.getElementById('apiStatus');
            const testBtn = document.getElementById('testBtn');
            const generateBtn = document.getElementById('generateBtn');
            
            if (selectedMethod === 2) {
                const div = document.getElementById('apiKeyDiv');
                const text = (div.textContent || div.innerText || '').trim();
                if (text.startsWith('sk-ant-api') || text.startsWith('AIzaSy')) {
                    apiKey = text;
                }
            }
            
            if (!apiKey) {
                status.innerHTML = '<div class="status error">âŒ APIã‚­ãƒ¼ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„</div>';
                return;
            }
            
            testBtn.disabled = true;
            testBtn.textContent = 'ğŸ”„ ãƒ†ã‚¹ãƒˆä¸­...';
            status.innerHTML = '<div class="status warning">â³ æ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...</div>';
            
            try {
                const endpoint = selectedAPI === 'claude' ? '/api/claude' : '/api/gemini';
                const requestBody = {
                    apiKey: apiKey,
                    prompt: 'Hello test',
                    temperature: 0.1
                };
                
                if (selectedAPI === 'gemini') {
                    requestBody.model = geminiModel;
                }
                
                const response = await fetch('http://localhost:3000' + endpoint, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(requestBody)
                });
                
                const data = await response.json();
                
                if (response.ok && (data.content || data.candidates)) {
                    apiConnected = true;
                    generateBtn.disabled = false;
                    status.innerHTML = '<div class="status success">âœ… æ¥ç¶šæˆåŠŸï¼AIç”ŸæˆãŒåˆ©ç”¨å¯èƒ½ã§ã™</div>';
                    localStorage.setItem(selectedAPI + 'ApiKey', apiKey);
                } else {
                    throw new Error(data.error?.message || data.error || 'Connection failed');
                }
            } catch (error) {
                apiConnected = false;
                generateBtn.disabled = true;
                status.innerHTML = `<div class="status error">âŒ æ¥ç¶šå¤±æ•—: ${error.message}</div>`;
            } finally {
                testBtn.disabled = false;
                testBtn.textContent = 'ğŸ”Œ æ¥ç¶šãƒ†ã‚¹ãƒˆ';
            }
        }
        
        // AIãƒ†ãƒ¼ãƒç”Ÿæˆï¼ˆå®Œå…¨AIç”Ÿæˆï¼‰
        async function generateAITheme() {
            const btn = document.getElementById('aiThemeBtn');
            const display = document.getElementById('themeDisplay');
            
            if (!apiConnected) {
                alert('å…ˆã«APIæ¥ç¶šãƒ†ã‚¹ãƒˆã‚’æˆåŠŸã•ã›ã¦ãã ã•ã„');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = 'ğŸ¤– ç”Ÿæˆä¸­...';
            display.textContent = 'AIãŒç‹¬å‰µçš„ãªãƒ†ãƒ¼ãƒã‚’è€ƒæ¡ˆä¸­...';
            
            try {
                const category = document.getElementById('themeCategory').value;
                const randomSeed = Math.floor(Math.random() * 10000);
                
                // ã‚«ãƒ†ã‚´ãƒªãƒ¼ã®è¨­å®š
                let categoryText = '';
                if (category !== 'random') {
                    const categoryMap = {
                        'romance': currentLanguage === 'ja' ? 'æ‹æ„›ãƒ»ãƒ­ãƒãƒ³ã‚¹' : 'Romance',
                        'friendship': currentLanguage === 'ja' ? 'å‹æƒ…ãƒ»çµ†' : 'Friendship',
                        'dream': currentLanguage === 'ja' ? 'å¤¢ãƒ»æŒ‘æˆ¦' : 'Dreams & Ambitions',
                        'daily': currentLanguage === 'ja' ? 'æ—¥å¸¸ãƒ»ç”Ÿæ´»' : 'Daily Life',
                        'digital': currentLanguage === 'ja' ? 'ãƒ‡ã‚¸ã‚¿ãƒ«ãƒ»ãƒ†ã‚¯ãƒãƒ­ã‚¸ãƒ¼' : 'Digital & Tech',
                        'fantasy': currentLanguage === 'ja' ? 'ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼ãƒ»SF' : 'Fantasy & Sci-Fi',
                        'dark': currentLanguage === 'ja' ? 'ãƒ€ãƒ¼ã‚¯ãƒ»ã‚·ãƒªã‚¢ã‚¹' : 'Dark & Serious',
                        'nostalgia': currentLanguage === 'ja' ? 'ãƒã‚¹ã‚¿ãƒ«ã‚¸ãƒ¼ãƒ»ãƒ¬ãƒˆãƒ­' : 'Nostalgia & Retro',
                        'adventure': currentLanguage === 'ja' ? 'å†’é™ºãƒ»ã‚¢ã‚¯ã‚·ãƒ§ãƒ³' : 'Adventure & Action',
                        'mystery': currentLanguage === 'ja' ? 'ãƒŸã‚¹ãƒ†ãƒªãƒ¼ãƒ»ã‚µã‚¹ãƒšãƒ³ã‚¹' : 'Mystery & Suspense',
                        'comedy': currentLanguage === 'ja' ? 'ã‚³ãƒ¡ãƒ‡ã‚£ãƒ»ãƒ¦ãƒ¼ãƒ¢ã‚¢' : 'Comedy & Humor',
                        'sports': currentLanguage === 'ja' ? 'ã‚¹ãƒãƒ¼ãƒ„ãƒ»ç«¶æŠ€' : 'Sports',
                        'art': currentLanguage === 'ja' ? 'éŸ³æ¥½ãƒ»ã‚¢ãƒ¼ãƒˆ' : 'Music & Art',
                        'school': currentLanguage === 'ja' ? 'å­¦åœ’ãƒ»ã‚¹ã‚¯ãƒ¼ãƒ«' : 'School Life',
                        'work': currentLanguage === 'ja' ? 'ä»•äº‹ãƒ»ãƒ“ã‚¸ãƒã‚¹' : 'Work & Business',
                        'travel': currentLanguage === 'ja' ? 'æ—…è¡Œãƒ»è¦³å…‰' : 'Travel',
                        'food': currentLanguage === 'ja' ? 'é£Ÿã¹ç‰©ãƒ»ã‚°ãƒ«ãƒ¡' : 'Food & Cuisine',
                        'pet': currentLanguage === 'ja' ? 'ãƒšãƒƒãƒˆãƒ»å‹•ç‰©' : 'Pets & Animals',
                        'nature': currentLanguage === 'ja' ? 'è‡ªç„¶ãƒ»é¢¨æ™¯' : 'Nature & Landscape'
                    };
                    categoryText = categoryMap[category] || '';
                }
                
                // AIãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
                const prompt = currentLanguage === 'ja' ? 
                    `ã€ã‚¿ã‚¹ã‚¯ã€‘2025å¹´ã«SNSã§ãƒã‚ºã‚Šãã†ãªæ¥½æ›²ãƒ†ãƒ¼ãƒã‚’1ã¤ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚

ã€æ¡ä»¶ã€‘
${categoryText ? `- ã‚«ãƒ†ã‚´ãƒªãƒ¼: ${categoryText}` : '- ã‚«ãƒ†ã‚´ãƒªãƒ¼: è‡ªç”±ã«é¸æŠ'}
- ãƒ©ãƒ³ãƒ€ãƒ ã‚·ãƒ¼ãƒ‰: ${randomSeed}
- æ™‚ä»£: 2025å¹´ã®ãƒˆãƒ¬ãƒ³ãƒ‰

ã€è¦ä»¶ã€‘
1. å®Œå…¨ã«ã‚ªãƒªã‚¸ãƒŠãƒ«ã§é©æ–°çš„ãªãƒ†ãƒ¼ãƒ
2. æ„Ÿæƒ…ã‚’å¼·ãæºã•ã¶ã‚‹å†…å®¹
3. SNSã§æ‹¡æ•£ã•ã‚Œã‚„ã™ã„
4. 10æ–‡å­—ä»¥å†…ã®çŸ­ã„ãƒ•ãƒ¬ãƒ¼ã‚º
5. è¨˜æ†¶ã«æ®‹ã‚Šã‚„ã™ã„

ã€é¿ã‘ã‚‹ã¹ãã“ã¨ã€‘
- ã‚ã‚ŠããŸã‚Šãªè¡¨ç¾
- æ—¢å­˜ã®æœ‰åæ›²ã®ã‚¿ã‚¤ãƒˆãƒ«
${generatedThemes.length > 0 ? `- æ¬¡ã®ãƒ†ãƒ¼ãƒã¨ä¼¼ãŸã‚‚ã®: ${generatedThemes.slice(-3).join(', ')}` : ''}

ãƒ†ãƒ¼ãƒã‚’1ã¤ã ã‘å‡ºåŠ›ã€‚èª¬æ˜ä¸è¦ã€‚` :
                    `[TASK] Generate one viral music theme for 2025.

[CONDITIONS]
${categoryText ? `- Category: ${categoryText}` : '- Category: Your choice'}
- Random seed: ${randomSeed}
- Era: 2025 trends

[REQUIREMENTS]
1. Completely original and innovative
2. Emotionally impactful
3. Shareable on social media
4. Maximum 5 words
5. Memorable

[AVOID]
- ClichÃ©s
- Existing song titles
${generatedThemes.length > 0 ? `- Similar to: ${generatedThemes.slice(-3).join(', ')}` : ''}

Output only the theme. No explanation.`;
                
                let theme = await callAI(prompt);
                theme = theme.trim().replace(/[\n\r]/g, '').replace(/^[ã€Œã€"']|[ã€ã€"']$/g, '');
                
                const maxLength = currentLanguage === 'ja' ? 15 : 30;
                if (theme.length > maxLength) {
                    theme = theme.substring(0, maxLength);
                }
                
                currentTheme = theme;
                display.textContent = 'ğŸ”¥ ' + currentTheme;
                
                generatedThemes.push(theme);
                if (generatedThemes.length > 10) {
                    generatedThemes.shift();
                }
                
            } catch (error) {
                console.error('AI theme generation failed:', error);
                alert('AIãƒ†ãƒ¼ãƒç”Ÿæˆã«å¤±æ•—ã—ã¾ã—ãŸã€‚APIæ¥ç¶šã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚');
                display.textContent = 'ãƒ†ãƒ¼ãƒç”Ÿæˆã‚¨ãƒ©ãƒ¼';
            } finally {
                btn.disabled = false;
                btn.textContent = 'ğŸ¤– AIãƒ†ãƒ¼ãƒç”Ÿæˆï¼ˆå®Œå…¨ã‚ªãƒªã‚¸ãƒŠãƒ«ï¼‰';
            }
        }
        
        // æ¥½æ›²ç”Ÿæˆ
        async function generateSong() {
            if (!currentTheme) {
                alert('å…ˆã«ãƒ†ãƒ¼ãƒã‚’ç”Ÿæˆã—ã¦ãã ã•ã„');
                return;
            }
            
            if (!apiConnected) {
                alert('å…ˆã«APIæ¥ç¶šãƒ†ã‚¹ãƒˆã‚’æˆåŠŸã•ã›ã¦ãã ã•ã„');
                return;
            }
            
            if (isGenerating) return;
            
            const btn = document.getElementById('generateBtn');
            const results = document.getElementById('results');
            
            isGenerating = true;
            btn.disabled = true;
            btn.textContent = 'ğŸ”„ ç”Ÿæˆä¸­...';
            
            results.innerHTML = '<div class="status warning">ğŸµ æ¥½æ›²ã‚’ç”Ÿæˆä¸­...</div>';
            
            try {
                // ã‚¿ã‚¤ãƒˆãƒ«ç”Ÿæˆï¼ˆæ—¥è‹±ä¸¡æ–¹ï¼‰
                const titleJa = await callAI(`"${currentTheme}"ã®æ—¥æœ¬èªæ¥½æ›²ã‚¿ã‚¤ãƒˆãƒ«ã‚’1ã¤ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚å°è±¡çš„ã§è¦šãˆã‚„ã™ã„ã‚¿ã‚¤ãƒˆãƒ«ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã®ã¿å‡ºåŠ›ã€‚`);
                const titleEn = await callAI(`"${currentTheme}"ã®è‹±èªæ¥½æ›²ã‚¿ã‚¤ãƒˆãƒ«ã‚’1ã¤ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚ã‚­ãƒ£ãƒƒãƒãƒ¼ã§è¦šãˆã‚„ã™ã„ã‚¿ã‚¤ãƒˆãƒ«ã€‚ã‚¿ã‚¤ãƒˆãƒ«ã®ã¿å‡ºåŠ›ã€‚`);
                
                // æ—¥æœ¬èªæ­Œè©ç”Ÿæˆ
                const lyricsJP = await callAI(`${currentTheme}ã®æ—¥æœ¬èªæ­Œè©ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚3åˆ†ç¨‹åº¦ã®æ¥½æ›²ã‚’æƒ³å®šã—ã¦ã€ä»¥ä¸‹ã®æ§‹æˆã§ï¼š
[Intro] (2è¡Œ)
[Verse 1] (4è¡Œ)
[Pre-Chorus] (2è¡Œ)
[Chorus] (4è¡Œ)
[Verse 2] (4è¡Œ)
[Pre-Chorus] (2è¡Œ)
[Chorus] (4è¡Œ)
[Bridge] (4è¡Œ)
[Chorus] (4è¡Œ)
[Outro] (2è¡Œ)
æ„Ÿæƒ…ã‚’è¾¼ã‚ã¦ã€‚æ­Œè©ã®ã¿ã‚’å‡ºåŠ›ã€‚`);
                
                // è‹±èªæ­Œè©ç”Ÿæˆ
                const lyricsEN = await callAI(`${currentTheme}ã®è‹±èªæ­Œè©ã‚’ä½œæˆã—ã¦ãã ã•ã„ã€‚3åˆ†ç¨‹åº¦ã®æ¥½æ›²ã‚’æƒ³å®šã—ã¦ã€ä»¥ä¸‹ã®æ§‹æˆã§ï¼š
[Intro] (2è¡Œ)
[Verse 1] (4è¡Œ)
[Pre-Chorus] (2è¡Œ)
[Chorus] (4è¡Œ)
[Verse 2] (4è¡Œ)
[Pre-Chorus] (2è¡Œ)
[Chorus] (4è¡Œ)
[Bridge] (4è¡Œ)
[Chorus] (4è¡Œ)
[Outro] (2è¡Œ)
ã‚­ãƒ£ãƒƒãƒãƒ¼ãªè‹±èªæ­Œè©ã€‚æ­Œè©ã®ã¿ã‚’å‡ºåŠ›ã€‚`);
                
                // ã‚¹ã‚¿ã‚¤ãƒ«ç”Ÿæˆ
                const style = await callAI(`"${currentTheme}"ã®éŸ³æ¥½ã‚¹ã‚¿ã‚¤ãƒ«ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„ã€‚ã‚¸ãƒ£ãƒ³ãƒ«ã€ãƒ ãƒ¼ãƒ‰ã€BPMã‚’å«ã‚ã¦20èªä»¥å†…ã§ã€‚`);
                
                // Midjourneyãƒ—ãƒ­ãƒ³ãƒ—ãƒˆç”Ÿæˆ
                const artwork = await callAI(`"${currentTheme}"ã®Midjourneyãƒ—ãƒ­ãƒ³ãƒ—ãƒˆã‚’è‹±èª30å­—ä»¥å†…ã§ç”Ÿæˆã€‚ç°¡æ½”ã«ã€‚`);
                
                currentData = {
                    titleJa: titleJa,
                    titleEn: titleEn,
                    lyricsJP: lyricsJP,
                    lyricsEN: lyricsEN,
                    style: style,
                    artwork: artwork
                };
                
                displayResults(currentData);
                
            } catch (error) {
                results.innerHTML = `<div class="status error">âŒ ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
            } finally {
                isGenerating = false;
                btn.disabled = false;
                btn.textContent = 'ğŸš€ 3åˆ†æ¥½æ›²ã‚’ç”Ÿæˆï¼ˆè¦APIæ¥ç¶šï¼‰';
            }
        }
        
        // AI APIå‘¼ã³å‡ºã—
        async function callAI(prompt) {
            const endpoint = selectedAPI === 'claude' ? '/api/claude' : '/api/gemini';
            
            const requestBody = {
                apiKey: apiKey,
                prompt: prompt,
                temperature: 0.9
            };
            
            if (selectedAPI === 'gemini') {
                requestBody.model = geminiModel;
            }
            
            const response = await fetch('http://localhost:3000' + endpoint, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(requestBody)
            });
            
            const data = await response.json();
            
            if (!response.ok) {
                throw new Error(data.error || 'API Error');
            }
            
            if (selectedAPI === 'claude' && data.content && data.content[0]) {
                return data.content[0].text;
            } else if (selectedAPI === 'gemini' && data.candidates && data.candidates[0]) {
                return data.candidates[0].content.parts[0].text;
            } else {
                throw new Error('No response from API');
            }
        }
        
        // çµæœè¡¨ç¤º
        function displayResults(content) {
            const results = document.getElementById('results');
            
            results.innerHTML = `
                <div class="result-box">
                    <div class="result-header">
                        ğŸµ æ¥½æ›²ã‚¿ã‚¤ãƒˆãƒ«ï¼ˆæ—¥æœ¬èªï¼‰
                        <button class="copy-btn" onclick="copyTitleJa()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content" id="titleJaContent">${content.titleJa}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸµ Song Title (English)
                        <button class="copy-btn" onclick="copyTitleEn()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content" id="titleEnContent">${content.titleEn}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸŒ æ—¥æœ¬èªæ­Œè©ï¼ˆ3åˆ†æ¥½æ›²ç”¨ï¼‰
                        <button class="copy-btn" onclick="copyLyricsJP()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content" id="lyricsJPContent">${content.lyricsJP}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸ‡ºğŸ‡¸ è‹±èªæ­Œè©ï¼ˆ3åˆ†æ¥½æ›²ç”¨ï¼‰
                        <button class="copy-btn" onclick="copyLyricsEN()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content" id="lyricsENContent">${content.lyricsEN}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸ¨ éŸ³æ¥½ã‚¹ã‚¿ã‚¤ãƒ«
                        <button class="copy-btn" onclick="copyStyle()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content" id="styleContent">${content.style}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸ–¼ï¸ Midjourneyã‚¢ãƒ¼ãƒˆãƒ¯ãƒ¼ã‚¯
                        <button class="copy-btn" onclick="copyArtwork()">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="controls">
                        <label>æ¯”ç‡:</label>
                        <select id="aspectRatio" onchange="updateMjPrompt()">
                            <option value="1:1">1:1</option>
                            <option value="9:16">9:16</option>
                            <option value="16:9">16:9</option>
                        </select>
                        <label>ãƒ¢ãƒ‡ãƒ«:</label>
                        <select id="model" onchange="updateMjPrompt()">
                            <option value="v 7">v 7</option>
                            <option value="niji 6">niji 6</option>
                        </select>
                    </div>
                    <div class="result-content" id="artworkContent">${content.artwork} --ar 1:1 --v 7</div>
                </div>
            `;
        }
        
        // ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        function copyText(text) {
            const textArea = document.createElement('textarea');
            textArea.value = text;
            textArea.style.position = 'fixed';
            textArea.style.left = '-999999px';
            document.body.appendChild(textArea);
            textArea.select();
            
            try {
                document.execCommand('copy');
                alert('ğŸ“‹ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼');
            } catch (err) {
                alert('ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸã€‚æ‰‹å‹•ã§ã‚³ãƒ”ãƒ¼ã—ã¦ãã ã•ã„ã€‚');
            }
            
            document.body.removeChild(textArea);
        }
        
        function copyTitleJa() {
            copyText(document.getElementById('titleJaContent').textContent);
        }
        
        function copyTitleEn() {
            copyText(document.getElementById('titleEnContent').textContent);
        }
        
        function copyLyricsJP() {
            copyText(document.getElementById('lyricsJPContent').textContent);
        }
        
        function copyLyricsEN() {
            copyText(document.getElementById('lyricsENContent').textContent);
        }
        
        function copyStyle() {
            copyText(document.getElementById('styleContent').textContent);
        }
        
        function copyArtwork() {
            copyText(document.getElementById('artworkContent').textContent);
        }
        
        // Midjourneyãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ›´æ–°
        function updateMjPrompt() {
            if (!currentData.artwork) return;
            
            const aspectRatio = document.getElementById('aspectRatio').value;
            const model = document.getElementById('model').value;
            const prompt = `${currentData.artwork} --ar ${aspectRatio} --${model}`;
            
            document.getElementById('artworkContent').textContent = prompt;
        }
    </script>
</body>
</html>