<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ğŸµ Gemini Suno Creator</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 900px;
            margin: 0 auto;
            background: white;
            border-radius: 20px;
            padding: 30px;
            box-shadow: 0 10px 30px rgba(0,0,0,0.2);
        }
        
        h1 {
            text-align: center;
            color: #667eea;
            margin-bottom: 30px;
            font-size: 2.5em;
        }
        
        .api-setup {
            background: #e3f2fd;
            border: 1px solid #2196f3;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 30px;
        }
        
        .api-input {
            width: 100%;
            padding: 12px;
            border: 1px solid #ddd;
            border-radius: 5px;
            margin-top: 10px;
            font-size: 16px;
        }
        
        .mode-selector {
            display: flex;
            gap: 10px;
            margin: 20px 0;
            flex-wrap: wrap;
        }
        
        .mode-btn {
            padding: 10px 20px;
            border: 2px solid #ddd;
            border-radius: 25px;
            background: white;
            cursor: pointer;
            transition: all 0.3s;
        }
        
        .mode-btn.active {
            border-color: #667eea;
            background: #667eea;
            color: white;
        }
        
        .generate-btn {
            display: block;
            width: 300px;
            margin: 0 auto 30px;
            padding: 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 50px;
            font-size: 18px;
            cursor: pointer;
            transition: transform 0.3s;
        }
        
        .generate-btn:hover:not(:disabled) {
            transform: translateY(-2px);
        }
        
        .generate-btn:disabled {
            background: #999;
            cursor: not-allowed;
        }
        
        .theme-box {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 15px;
            margin-bottom: 30px;
            text-align: center;
            font-size: 1.2em;
            font-weight: bold;
            color: #495057;
        }
        
        .results {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 20px;
        }
        
        .result-box {
            background: #f8f9fa;
            border-radius: 15px;
            padding: 20px;
        }
        
        .result-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 15px;
            font-weight: bold;
            color: #667eea;
        }
        
        .copy-btn {
            background: #28a745;
            color: white;
            border: none;
            padding: 8px 16px;
            border-radius: 20px;
            cursor: pointer;
            font-size: 12px;
        }
        
        .copy-btn:hover {
            background: #218838;
        }
        
        .result-content {
            background: white;
            padding: 15px;
            border-radius: 10px;
            font-family: monospace;
            font-size: 14px;
            line-height: 1.6;
            white-space: pre-wrap;
            max-height: 300px;
            overflow-y: auto;
        }
        
        .full-width {
            grid-column: 1 / -1;
        }
        
        .controls {
            display: flex;
            gap: 10px;
            margin: 15px 0;
        }
        
        .controls select {
            padding: 5px;
            border: 1px solid #ddd;
            border-radius: 5px;
        }
        
        .loading {
            text-align: center;
            padding: 40px;
            color: #666;
        }
        
        .spinner {
            border: 3px solid #f3f3f3;
            border-top: 3px solid #667eea;
            border-radius: 50%;
            width: 30px;
            height: 30px;
            animation: spin 1s linear infinite;
            margin: 0 auto 20px;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .message {
            position: fixed;
            top: 20px;
            right: 20px;
            background: #28a745;
            color: white;
            padding: 10px 20px;
            border-radius: 20px;
            opacity: 0;
            transition: opacity 0.3s;
            z-index: 1000;
        }
        
        .message.show {
            opacity: 1;
        }
        
        .message.error {
            background: #dc3545;
        }
        
        .message.warning {
            background: #ffc107;
            color: #333;
        }
        
        @media (max-width: 768px) {
            .results { grid-template-columns: 1fr; }
            h1 { font-size: 2em; }
        }
        
        .status {
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            text-align: center;
        }
        
        .status.connected {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        
        .status.disconnected {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸµ Gemini Suno Creator</h1>
        
        <div class="api-setup">
            <h3>ğŸ”§ Gemini AIè¨­å®š</h3>
            <div class="status" id="apiStatus">
                âŒ Gemini APIæœªæ¥ç¶š
            </div>
            <input type="password" id="apiKey" class="api-input" placeholder="Gemini API Keyã‚’å…¥åŠ›ã—ã¦ãã ã•ã„">
            <button onclick="testConnection()" style="margin-top: 10px; padding: 8px 16px; background: #2196f3; color: white; border: none; border-radius: 5px; cursor: pointer;">æ¥ç¶šãƒ†ã‚¹ãƒˆ</button>
            <small style="display: block; margin-top: 10px; color: #666;">
                API Keyã¯localStorageã«å®‰å…¨ã«ä¿å­˜ã•ã‚Œã¾ã™ã€‚<br>
                å–å¾—æ–¹æ³•: <a href="https://aistudio.google.com/app/apikey" target="_blank">Google AI Studio</a><br>
                <strong>æ³¨æ„:</strong> ãƒ¢ãƒã‚¤ãƒ«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã¯CORSåˆ¶é™ã«ã‚ˆã‚Šæ¥ç¶šã§ããªã„å ´åˆãŒã‚ã‚Šã¾ã™ã€‚<br>
                ãã®å ´åˆã¯è‡ªå‹•çš„ã«ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆãƒ¢ãƒ¼ãƒ‰ã«åˆ‡ã‚Šæ›¿ã‚ã‚Šã¾ã™ã€‚
            </small>
        </div>
        
        <div class="mode-selector">
            <div class="mode-btn active" onclick="selectMode('ai')" id="aiMode">
                ğŸ¤– AIç”Ÿæˆ (Gemini)
            </div>
            <div class="mode-btn" onclick="selectMode('local')" id="localMode">
                ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆ
            </div>
        </div>
        
        <button class="generate-btn" onclick="generate()" id="generateBtn">
            ğŸ² æ¥½æ›²ç”Ÿæˆ
        </button>
        
        <div class="theme-box" id="themeBox">
            ğŸ¯ ãƒœã‚¿ãƒ³ã‚’æŠ¼ã—ã¦æ¥½æ›²ã‚’ç”Ÿæˆã—ã¦ãã ã•ã„
        </div>
        
        <div class="results" id="results">
            <!-- çµæœãŒã“ã“ã«è¡¨ç¤ºã•ã‚Œã¾ã™ -->
        </div>
    </div>
    
    <div class="message" id="message"></div>

    <script>
        let currentData = null;
        let selectedMode = 'ai';
        let apiConnected = false;
        
        // ãƒ†ãƒ¼ãƒãƒ‡ãƒ¼ã‚¿
        const themes = [
            "æ™‚ã‚’ã‹ã‘ã‚‹æ‹ (ã‚¿ã‚¤ãƒ ãƒªãƒ¼ãƒ—, é‹å‘½, åˆ‡ãªã„æ‹)",
            "AIå°‘å¥³ã¨ã®æ‹ (äººå·¥çŸ¥èƒ½, ãƒ‡ã‚¸ã‚¿ãƒ«æ„›, æ„Ÿæƒ…)",
            "ç•°ä¸–ç•Œã§ã®å¤±æ‹ (ãƒ•ã‚¡ãƒ³ã‚¿ã‚¸ãƒ¼, é­”æ³•, åˆ¥ã‚Œ)",
            "ãƒ¯ãƒ¼ãƒ—ã—ãŸå…ˆã®å› (æ™‚ç©º, ç¬é–“ç§»å‹•, å†ä¼š)",
            "ãƒ‡ã‚¸ã‚¿ãƒ«ä¸–ç•Œã®ç‰‡æƒ³ã„ (ãƒ¡ã‚¿ãƒãƒ¼ã‚¹, ã‚¢ãƒã‚¿ãƒ¼, ã‚ªãƒ³ãƒ©ã‚¤ãƒ³)",
            "ãƒ«ãƒ¼ãƒ—ã™ã‚‹å‘Šç™½ (ç„¡é™ãƒ«ãƒ¼ãƒ—, ç¹°ã‚Šè¿”ã—, è«¦ã‚)",
            "AIãŒæ­Œã†å¤±æ‹æ­Œ (æ©Ÿæ¢°ã®å¿ƒ, å­¦ç¿’, ãƒ‡ãƒ¼ã‚¿)",
            "ç•°æ¬¡å…ƒæ‹æ„›äº‹æƒ… (ãƒ‘ãƒ©ãƒ¬ãƒ«ãƒ¯ãƒ¼ãƒ«ãƒ‰, åˆ¥ã®è‡ªåˆ†)",
            "ã‚µã‚¤ãƒãƒ¼ç©ºé–“ã®åˆæ‹ (ãƒãƒƒãƒˆ, ã‚³ãƒ¼ãƒ‰, ãƒ—ãƒ­ã‚°ãƒ©ãƒ )",
            "æ™‚é–“åœæ­¢ä¸­ã®æ‹ (é™æ­¢, æ°¸é , ç¬é–“)",
            "ãƒ›ãƒ­ã‚°ãƒ©ãƒ ã®æ‹äºº (å…‰, å¹»å½±, è§¦ã‚Œã‚‰ã‚Œãªã„)",
            "è¨˜æ†¶ã‚’æ¶ˆã•ã‚ŒãŸæ‹ (å¿˜å´, æ€ã„å‡º, æ¶ˆå»)",
            "é‡å­ã‚‚ã¤ã‚Œã®æ„› (é‡å­ç‰©ç†å­¦, åŒæœŸ, è·é›¢ç„¡é–¢ä¿‚)",
            "ãƒãƒ¼ãƒãƒ£ãƒ«çµå©šå¼ (ä»®æƒ³ç¾å®Ÿ, ã‚»ãƒ¬ãƒ¢ãƒ‹ãƒ¼, ãƒ‡ã‚¸ã‚¿ãƒ«èª“ã„)",
            "ãƒã‚ªãƒ³ãƒ©ã‚¤ãƒˆã®ä¸‹ã§ (éƒ½å¸‚å¤œæ™¯, å…‰, å‡ºä¼šã„)",
            "ãƒ¡ã‚¿ãƒãƒ¼ã‚¹ã®ç§˜å¯† (éš ã•ã‚ŒãŸçœŸå®Ÿ, æ¢ç´¢, è¬)",
            "ã‚¿ã‚¤ãƒ ãƒ‘ãƒ©ãƒ‰ãƒƒã‚¯ã‚¹æ‹æ„› (æ™‚é–“çŸ›ç›¾, å› æœé–¢ä¿‚, è¤‡é›‘)",
            "AIã‚¢ã‚·ã‚¹ã‚¿ãƒ³ãƒˆã¸ã®æƒ³ã„ (äººå·¥çŸ¥èƒ½, æ—¥å¸¸, ä¾å­˜)",
            "ç•°ä¸–ç•Œè»¢ç”Ÿå¾Œã®å†ä¼š (è»¢ç”Ÿ, å‰ä¸–, è¨˜æ†¶)",
            "æœªæ¥ã‹ã‚‰ã®æ‰‹ç´™ (ã‚¿ã‚¤ãƒ ãƒ¡ãƒ¼ãƒ«, äºˆè¨€, è­¦å‘Š)"
        ];
        
        // ãƒ¢ãƒ¼ãƒ‰é¸æŠ
        function selectMode(mode) {
            selectedMode = mode;
            document.getElementById('aiMode').classList.toggle('active', mode === 'ai');
            document.getElementById('localMode').classList.toggle('active', mode === 'local');
            
            const btn = document.getElementById('generateBtn');
            if (mode === 'ai') {
                btn.textContent = apiConnected ? 'ğŸ¤– AIæ¥½æ›²ç”Ÿæˆ' : 'ğŸ”§ APIæ¥ç¶šãŒå¿…è¦';
                btn.disabled = !apiConnected;
            } else {
                btn.textContent = 'ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«æ¥½æ›²ç”Ÿæˆ';
                btn.disabled = false;
            }
        }
        
        // Gemini Flash ãƒ¢ãƒ‡ãƒ«ã®ã¿ä½¿ç”¨
        const workingModel = 'gemini-1.5-flash';
        
        // APIæ¥ç¶šãƒ†ã‚¹ãƒˆ
        async function testConnection() {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (!apiKey) {
                showMessage('API Keyã‚’å…¥åŠ›ã—ã¦ãã ã•ã„', 'error');
                return;
            }
            
            const status = document.getElementById('apiStatus');
            status.textContent = 'ğŸ”„ Gemini-Flashæ¥ç¶šãƒ†ã‚¹ãƒˆä¸­...';
            status.className = 'status';
            
            try {
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${workingModel}:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{ text: 'Hello' }]
                        }],
                        generationConfig: {
                            temperature: 0.7,
                            maxOutputTokens: 50,
                        }
                    })
                });
                
                const responseData = await response.json();
                console.log('Gemini Flash Response:', responseData);
                
                if (response.ok && responseData.candidates && responseData.candidates.length > 0) {
                    apiConnected = true;
                    localStorage.setItem('gemini_api_key', apiKey);
                    status.textContent = 'âœ… Gemini Flash æ¥ç¶šæˆåŠŸ';
                    status.className = 'status connected';
                    showMessage('âœ… Gemini Flash æ¥ç¶šæˆåŠŸ', 'success');
                    selectMode('ai');
                } else {
                    throw new Error(`API Error: ${response.status} - ${responseData.error?.message || JSON.stringify(responseData)}`);
                }
            } catch (error) {
                console.error('APIæ¥ç¶šã‚¨ãƒ©ãƒ¼:', error);
                apiConnected = false;
                status.textContent = 'âŒ æ¥ç¶šå¤±æ•—';
                status.className = 'status disconnected';
                showMessage('âŒ APIæ¥ç¶šå¤±æ•— - ãƒ­ãƒ¼ã‚«ãƒ«ãƒ¢ãƒ¼ãƒ‰ã‚’ä½¿ç”¨ã—ã¦ãã ã•ã„', 'error');
                selectMode('local');
            }
        }
        
        // Gemini APIå‘¼ã³å‡ºã—
        async function callGeminiAPI(prompt) {
            const apiKey = document.getElementById('apiKey').value.trim();
            if (!apiKey) {
                throw new Error('API Key not found');
            }
            
            const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/${workingModel}:generateContent?key=${apiKey}`, {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json',
                },
                body: JSON.stringify({
                    contents: [{
                        parts: [{ text: prompt }]
                    }],
                    generationConfig: {
                        temperature: 0.9,
                        maxOutputTokens: 1000,
                    }
                })
            });
            
            const data = await response.json();
            console.log('Gemini API Response:', data);
            
            if (!response.ok) {
                throw new Error(`API Error: ${response.status} - ${data.error?.message || 'Unknown error'}`);
            }
            
            if (!data.candidates || data.candidates.length === 0) {
                throw new Error('No response generated');
            }
            
            return data.candidates[0].content.parts[0].text;
        }
        
        // AIç”Ÿæˆé–¢æ•°
        async function generateWithAI(theme) {
            // å¼·åŒ–ã•ã‚ŒãŸãƒ©ãƒ³ãƒ€ãƒ æ€§ã¨ãƒ¦ãƒ‹ãƒ¼ã‚¯æ€§
            const timestamp = Date.now();
            const randomSeed = timestamp % 100000;
            const extraRandom = Math.floor(Math.random() * 999999);
            
            // ã•ã‚‰ã«å¤šæ§˜åŒ–ã‚’ä¿ƒã™ãƒ—ãƒ­ãƒ³ãƒ—ãƒˆ
            const styleVariations = ['experimental', 'traditional', 'modern', 'vintage', 'futuristic', 'minimalist', 'epic', 'intimate'];
            const styleHint = styleVariations[Math.floor(Math.random() * styleVariations.length)];
            
            const moodVariations = ['mysterious', 'uplifting', 'melancholic', 'energetic', 'dreamy', 'intense', 'peaceful', 'dramatic'];
            const moodHint = moodVariations[Math.floor(Math.random() * moodVariations.length)];
            
            const prompts = {
                title: `Create a completely unique and original song title for "${theme}". Make it ${styleHint} and memorable. Avoid common words. Unique ID: ${randomSeed}-${extraRandom}. ONLY the title.`,
                
                lyricsJP: `Create completely original Japanese lyrics for "${theme}" with ${moodHint} mood. Use unique metaphors and fresh expressions. Structure: [Verse 1], [Chorus], [Verse 2], [Chorus], [Bridge], [Final Chorus]. Make it totally different from typical songs. ID: ${randomSeed}${extraRandom}. ONLY lyrics.`,
                
                lyricsEN: `Write totally original English lyrics for "${theme}" with ${styleHint} style. Use creative wordplay and unique imagery. Structure: [Verse 1], [Chorus], [Verse 2], [Chorus], [Bridge], [Final Chorus]. Make it completely fresh and different. ID: ${randomSeed + extraRandom}. ONLY lyrics.`,
                
                stylePrompt: `Create ${styleHint} style for "${theme}": Unique genre, ${moodHint} mood, specific tempo. 25 words max. ID: ${randomSeed + 1000}.`,
                
                midjourneyPrompt: `"${theme}" ${styleHint} art: unique style, specific colors, ${moodHint} atmosphere. 20 words max. ID: ${extraRandom}.`
            };
            
            const results = {};
            
            for (const [key, prompt] of Object.entries(prompts)) {
                try {
                    results[key] = await callGeminiAPI(prompt);
                    // å°‘ã—å¾…æ©Ÿã—ã¦ãƒ¬ãƒ¼ãƒˆåˆ¶é™ã‚’é¿ã‘ã‚‹
                    await new Promise(resolve => setTimeout(resolve, 1000));
                } catch (error) {
                    console.error(`${key}ç”Ÿæˆã‚¨ãƒ©ãƒ¼:`, error);
                    results[key] = `ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}`;
                }
            }
            
            return results;
        }
        
        // å¤§å¹…å¼·åŒ–ã•ã‚ŒãŸãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆ
        function generateLocally(theme) {
            const themeBase = theme.split(' (')[0];
            const timestamp = Date.now();
            const random = Math.floor(Math.random() * 999999);
            
            // ã‚¿ã‚¤ãƒˆãƒ«ç”Ÿæˆãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
            const titlePrefixes = ['', 'Digital ', 'Neon ', 'Cyber ', 'Virtual ', 'Electric ', 'Quantum ', 'Holographic ', 'Synthetic ', 'Neural ', 'Binary ', 'Cosmic ', 'Ethereal ', 'Phantom ', 'Crystal '];
            const titleSuffixes = ['', ' 2024', ' Protocol', ' Dreams', ' Reality', ' Code', ' Pulse', ' Wave', ' Matrix', ' Glitch', ' Symphony', ' Echo', ' Mirage', ' Paradox', ' Algorithm'];
            const titleStyles = ['', 'âˆ', 'â—Š', 'â—‡', 'â–³', 'â–½', 'â—¯', 'â—', 'â˜…', 'â˜†', 'â™¦', 'â™¢', 'âŸ¡', 'â¬Ÿ', 'â¬¢'];
            
            const titlePrefix = titlePrefixes[Math.floor(Math.random() * titlePrefixes.length)];
            const titleSuffix = titleSuffixes[Math.floor(Math.random() * titleSuffixes.length)];
            const titleStyle = titleStyles[Math.floor(Math.random() * titleStyles.length)];
            
            // æ—¥æœ¬èªæ­Œè©ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
            const jpSettings = ['å¤œã®è¡—è§’', 'æœã®çª“è¾º', 'å¤•æ–¹ã®ç©º', 'æ·±å¤œã®æµ·', 'é™å¯‚ã®éƒ¨å±‹', 'è³‘ã‚„ã‹ãªã‚«ãƒ•ã‚§', 'ãƒ‡ã‚¸ã‚¿ãƒ«ã®æ£®', 'ã‚µã‚¤ãƒãƒ¼ãªè¡—', 'ãƒãƒ¼ãƒãƒ£ãƒ«ç©ºé–“', 'é›»è„³ä¸–ç•Œ', 'ãƒã‚ªãƒ³è¡—', 'é‡å­ã®æµ·', 'ãƒ›ãƒ­ã‚°ãƒ©ãƒ ã®åº­', 'ãƒ‡ãƒ¼ã‚¿ã®è¿·å®®', 'ã‚³ãƒ¼ãƒ‰ã®åŸ', 'ãƒ”ã‚¯ã‚»ãƒ«ã®é›²', 'å…‰ã®å›å»Š', 'éŸ³ã®çµç•Œ', 'æ™‚ã®éš™é–“', 'å¤¢ã®å¢ƒç•Œ'];
            const jpActions = ['å›ã‚’è¦‹ã¤ã‘ãŸ', 'æ„›ã‚’æ„Ÿã˜ãŸ', 'é‹å‘½ã‚’çŸ¥ã£ãŸ', 'çœŸå®Ÿã«æ°—ã¥ã„ãŸ', 'å¸Œæœ›ã‚’è¦‹ãŸ', 'å¥‡è·¡ã‚’ä¿¡ã˜ãŸ', 'æƒ³ã„ã‚’è¾¼ã‚ãŸ', 'ç´„æŸã‚’äº¤ã‚ã—ãŸ', 'çµ†ã‚’çµã‚“ã ', 'æœªæ¥ã‚’æã„ãŸ', 'éå»ã‚’æŒ¯ã‚Šè¿”ã£ãŸ', 'ä»Šã‚’ç”Ÿãã¦ã„ã‚‹', 'å¿ƒã‚’é–‹ã„ãŸ', 'æ‰‰ã‚’å©ã„ãŸ', 'ç­”ãˆã‚’æ¢ã—ãŸ'];
            const jpEmotions = ['ãƒ”ã‚¯ã‚»ãƒ«ã®ä¸­ã«å®¿ã‚‹æƒ³ã„', 'ãƒ‡ãƒ¼ã‚¿ã«åˆ»ã¾ã‚ŒãŸæ„›', 'ã‚³ãƒ¼ãƒ‰ã«è¾¼ã‚ãŸæ°—æŒã¡', 'ãƒã‚¤ãƒŠãƒªã§èªã‚‹å¿ƒ', 'ã‚¢ãƒ«ã‚´ãƒªã‚ºãƒ ãªæ„Ÿæƒ…', 'é‡å­ã‚‚ã¤ã‚ŒãŸé­‚', 'ãƒ‡ã‚¸ã‚¿ãƒ«ãªæ¸©ã‚‚ã‚Š', 'ãƒãƒ¼ãƒãƒ£ãƒ«ãªçµ†', 'ã‚µã‚¤ãƒãƒ¼ãªæ„›æƒ…', 'ãƒã‚ªãƒ³ãªæ‹å¿ƒ', 'é›»å­ã®é¼“å‹•', 'å…‰ã®è¨˜æ†¶', 'éŸ³ã®æƒ³ã„å‡º', 'è‰²ã®æ„Ÿæƒ…', 'å½¢ã®é¡˜ã„'];
            const jpChorus = ['è¼ã', 'å…‰ã‚‹', 'éŸ¿ã', 'æµã‚Œã‚‹', 'è¸Šã‚‹', 'æ­Œã†', 'å¥ã§ã‚‹', 'ç´¡ã', 'ç¹”ã‚Šãªã™', 'æã', 'åˆ»ã‚€', 'çµã¶', 'ç¹‹ã', 'åºƒãŒã‚‹', 'æ·±ã¾ã‚‹'];
            
            // è‹±èªæ­Œè©ãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
            const enSettings = ['digital maze', 'cyber space', 'virtual world', 'neon city', 'data stream', 'quantum field', 'pixel paradise', 'code cathedral', 'holographic hall', 'electric ocean', 'binary beach', 'synthetic sky', 'algorithmic avenue', 'neural network', 'virtual valley', 'crystal chamber', 'sonic sanctuary', 'photon plaza', 'electron estate', 'quantum quarters'];
            const enDiscoveries = ['Found you', 'Met you', 'Saw you', 'Caught you', 'Discovered you', 'Located you', 'Encountered you', 'Spotted you', 'Noticed you', 'Glimpsed you', 'Reached you', 'Touched you', 'Felt you', 'Heard you', 'Sensed you'];
            const enVisuals = ['Pixels dancing', 'Data flowing', 'Code streaming', 'Light pulsing', 'Energy flowing', 'Circuits glowing', 'Holograms shifting', 'Patterns moving', 'Colors changing', 'Signals racing', 'Waves crashing', 'Sparks flying', 'Beams crossing', 'Rays bending', 'Streams merging'];
            const enFeels = ['electric soul', 'digital heart', 'cyber mind', 'quantum spirit', 'virtual essence', 'synthetic dreams', 'holographic thoughts', 'binary emotions', 'algorithmic love', 'neural connections', 'photonic pulse', 'sonic vibration', 'chromatic feeling', 'geometric passion', 'fractal desire'];
            
            // ã‚¹ã‚¿ã‚¤ãƒ«ç”Ÿæˆãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
            const genres = ['Electronic Pop', 'Synthwave', 'Cyberpop', 'Future Bass', 'Chillwave', 'Darksynth', 'Vaporwave', 'Retrowave', 'Ambient Pop', 'Electropop', 'Dream Pop', 'Synthpop', 'New Wave', 'Progressive Electronic', 'Ethereal Wave', 'Digital Funk', 'Cyber Jazz', 'Quantum Blues', 'Virtual Rock', 'Holographic Hip-Hop'];
            const moods = ['emotional', 'dreamy', 'energetic', 'melancholic', 'uplifting', 'mysterious', 'intense', 'peaceful', 'dramatic', 'romantic', 'nostalgic', 'futuristic', 'ethereal', 'powerful', 'intimate', 'epic', 'minimalist', 'experimental', 'cinematic', 'ambient'];
            const tempos = ['80 BPM', '90 BPM', '100 BPM', '110 BPM', '120 BPM', '130 BPM', '140 BPM', '85 BPM', '95 BPM', '105 BPM', '115 BPM', '125 BPM', '135 BPM', '72 BPM', '128 BPM', '150 BPM', '160 BPM', '75 BPM', '88 BPM', '132 BPM'];
            
            // Midjourneyãƒãƒªã‚¨ãƒ¼ã‚·ãƒ§ãƒ³
            const artStyles = ['cyberpunk', 'synthwave', 'vaporwave', 'futuristic', 'digital art', 'neon art', 'holographic', 'glitch art', 'pixel art', 'vector art', 'abstract', 'minimalist', 'surreal', 'cosmic', 'ethereal', 'cinematic', 'photorealistic', 'impressionist', 'expressionist', 'pop art'];
            const colorSchemes = ['neon colors', 'pastel gradients', 'electric blue', 'hot pink', 'purple hues', 'cyan tones', 'golden yellow', 'emerald green', 'crimson red', 'violet shades', 'turquoise', 'magenta', 'amber glow', 'silver gleam', 'copper shine', 'rainbow spectrum', 'monochrome', 'sepia tones', 'technicolor', 'prismatic'];
            const atmospheres = ['romantic', 'mysterious', 'dramatic', 'peaceful', 'intense', 'dreamy', 'epic', 'intimate', 'nostalgic', 'futuristic', 'ethereal', 'powerful', 'serene', 'vibrant', 'melancholic', 'uplifting', 'dark', 'bright', 'cosmic', 'urban'];
            
            // ãƒ©ãƒ³ãƒ€ãƒ é¸æŠ
            const jpSetting = jpSettings[random % jpSettings.length];
            const jpAction = jpActions[(random + 1) % jpActions.length];
            const jpEmotion = jpEmotions[(random + 2) % jpEmotions.length];
            const jpChorusWord = jpChorus[(random + 3) % jpChorus.length];
            
            const enSetting = enSettings[random % enSettings.length];
            const enDiscovery = enDiscoveries[(random + 1) % enDiscoveries.length];
            const enVisual = enVisuals[(random + 2) % enVisuals.length];
            const enFeel = enFeels[(random + 3) % enFeels.length];
            
            const genre = genres[random % genres.length];
            const mood = moods[(random + 1) % moods.length];
            const tempo = tempos[(random + 2) % tempos.length];
            
            const artStyle = artStyles[random % artStyles.length];
            const colorScheme = colorSchemes[(random + 1) % colorSchemes.length];
            const atmosphere = atmospheres[(random + 2) % atmospheres.length];
            
            return {
                title: `${titlePrefix}${themeBase}${titleSuffix}${titleStyle}`,
                
                lyricsJP: `[Verse 1]\n${jpSetting}ã§${jpAction}\n${jpEmotion}\n${themeBase}ãŒå¿ƒã«éŸ¿ã„ã¦\næ–°ã—ã„ä¸–ç•ŒãŒå§‹ã¾ã‚‹\n\n[Chorus]\n${themeBase}ãŒ${jpChorusWord}å¤œã«\nå›ã¨åƒ•ã®ç‰©èªã‚’æã“ã†\n${mood}ãªçµ†ã§çµã°ã‚Œã¦\næœªæ¥ã¸ã®æ‰‰ã‚’é–‹ã“ã†\n\n[Verse 2]\næ™‚ã‚’è¶…ãˆãŸæƒ³ã„ãŒ\nã‚³ãƒ¼ãƒ‰ã¨ãªã£ã¦æµã‚Œã¦ã\nãƒãƒ¼ãƒãƒ£ãƒ«ã§ã‚‚æœ¬ç‰©ã®\næ„›ãŒã“ã“ã«ã‚ã‚‹\n\n[Chorus]\n${themeBase}ãŒ${jpChorusWord}å¤œã«\nå›ã¨åƒ•ã®ç‰©èªã‚’æã“ã†\n${mood}ãªçµ†ã§çµã°ã‚Œã¦\næœªæ¥ã¸ã®æ‰‰ã‚’é–‹ã“ã†\n\n[Bridge]\n${jpEmotion}ãŒ\næ°¸é ã«éŸ¿ãç¶šã‘ã‚‹\n${themeBase}ã¯\nForever and beyond`,
                
                lyricsEN: `[Verse 1]\n${enDiscovery} in the ${enSetting} tonight\n${enVisual} in the ${colorScheme} light\nYour ${enFeel} calling out to me\nIn this ${atmosphere} symphony\n\n[Chorus]\n${themeBase} ${mood} and free\nDancing through eternity\nWith ${genre} in our hearts\nWe'll never be apart\n\n[Verse 2]\n${enVisual} through the digital space\nYour ${enFeel} I can't replace\nIn this world of ones and zeros\nWe're the ultimate heroes\n\n[Chorus]\n${themeBase} ${mood} and free\nDancing through eternity\nWith ${genre} in our hearts\nWe'll never be apart\n\n[Bridge]\nSometimes the signals fade away\nBut our love is here to stay\n${themeBase} will always be\nOur ${atmosphere} destiny`,
                
                stylePrompt: `${genre}, ${mood}, ${tempo}`,
                
                midjourneyPrompt: `${themeBase}, ${artStyle}, ${colorScheme}, ${atmosphere}`
            };
        }
        
        // ãƒ¡ã‚¤ãƒ³ç”Ÿæˆé–¢æ•°
        async function generate() {
            const btn = document.getElementById('generateBtn');
            const results = document.getElementById('results');
            const themeBox = document.getElementById('themeBox');
            
            // AI ãƒ¢ãƒ¼ãƒ‰ã§APIæœªæ¥ç¶šã®å ´åˆ
            if (selectedMode === 'ai' && !apiConnected) {
                showMessage('å…ˆã«APIæ¥ç¶šãƒ†ã‚¹ãƒˆã‚’è¡Œã£ã¦ãã ã•ã„', 'warning');
                return;
            }
            
            btn.disabled = true;
            btn.textContent = selectedMode === 'ai' ? 'ğŸ¤– AIç”Ÿæˆä¸­...' : 'ğŸ  ç”Ÿæˆä¸­...';
            
            try {
                const theme = themes[Math.floor(Math.random() * themes.length)];
                themeBox.textContent = 'ğŸ¯ ' + theme;
                
                results.innerHTML = '<div class="loading full-width"><div class="spinner"></div>' + 
                    (selectedMode === 'ai' ? 'Gemini AIãŒæ¥½æ›²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆä¸­...' : 'ãƒ­ãƒ¼ã‚«ãƒ«ã§æ¥½æ›²ã‚³ãƒ³ãƒ†ãƒ³ãƒ„ã‚’ç”Ÿæˆä¸­...') + '</div>';
                
                let generatedContent;
                if (selectedMode === 'ai') {
                    try {
                        generatedContent = await generateWithAI(theme);
                    } catch (error) {
                        console.error('AIç”Ÿæˆã‚¨ãƒ©ãƒ¼ã€ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆã«åˆ‡æ›¿:', error);
                        showMessage('âš ï¸ AIç”Ÿæˆã«å¤±æ•—ã€ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆã«åˆ‡æ›¿', 'warning');
                        results.innerHTML = '<div class="loading full-width"><div class="spinner"></div>ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆã«åˆ‡ã‚Šæ›¿ãˆä¸­...</div>';
                        await new Promise(resolve => setTimeout(resolve, 1000));
                        generatedContent = generateLocally(theme);
                        selectedMode = 'local';
                        selectMode('local');
                    }
                } else {
                    // ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆã®é…å»¶ã‚’ã‚·ãƒŸãƒ¥ãƒ¬ãƒ¼ãƒˆ
                    await new Promise(resolve => setTimeout(resolve, 2000));
                    generatedContent = generateLocally(theme);
                }
                
                currentData = {
                    theme: theme,
                    ...generatedContent
                };
                
                displayResults();
                showMessage(selectedMode === 'ai' ? 'ğŸ¤– AIç”Ÿæˆå®Œäº†' : 'ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«ç”Ÿæˆå®Œäº†');
                
            } catch (error) {
                console.error('ç”Ÿæˆã‚¨ãƒ©ãƒ¼:', error);
                results.innerHTML = `<div style="color: red; text-align: center; padding: 40px;">ç”Ÿæˆã‚¨ãƒ©ãƒ¼: ${error.message}</div>`;
                showMessage('ç”Ÿæˆã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ', 'error');
            } finally {
                btn.disabled = false;
                btn.textContent = selectedMode === 'ai' ? 'ğŸ¤– AIæ¥½æ›²ç”Ÿæˆ' : 'ğŸ  ãƒ­ãƒ¼ã‚«ãƒ«æ¥½æ›²ç”Ÿæˆ';
            }
        }
        
        // çµæœè¡¨ç¤º
        function displayResults() {
            const results = document.getElementById('results');
            
            results.innerHTML = `
                <div class="result-box">
                    <div class="result-header">
                        ğŸµ æ¥½æ›²ã‚¿ã‚¤ãƒˆãƒ«
                        <button class="copy-btn" onclick="copy('title')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content">${currentData.title}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸŒ æ—¥æœ¬èªæ­Œè©
                        <button class="copy-btn" onclick="copy('lyricsJP')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content">${currentData.lyricsJP}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸ‡ºğŸ‡¸ è‹±èªæ­Œè©
                        <button class="copy-btn" onclick="copy('lyricsEN')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content">${currentData.lyricsEN}</div>
                </div>
                
                <div class="result-box">
                    <div class="result-header">
                        ğŸ¨ Sunoã‚¹ã‚¿ã‚¤ãƒ«
                        <button class="copy-btn" onclick="copy('stylePrompt')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="result-content">${currentData.stylePrompt}</div>
                </div>
                
                <div class="result-box full-width">
                    <div class="result-header">
                        ğŸ–¼ï¸ Midjourneyç”»åƒ
                        <button class="copy-btn" onclick="copy('midjourneyPrompt')">ğŸ“‹ ã‚³ãƒ”ãƒ¼</button>
                    </div>
                    <div class="controls">
                        <label>æ¯”ç‡:</label>
                        <select id="aspectRatio" onchange="updateMjPrompt()">
                            <option value="1:1">1:1</option>
                            <option value="9:16">9:16</option>
                            <option value="16:9">16:9</option>
                        </select>
                        <label>ãƒ¢ãƒ‡ãƒ«:</label>
                        <select id="model" onchange="updateMjPrompt()">
                            <option value="v 7">v 7</option>
                            <option value="niji 6">niji 6</option>
                        </select>
                    </div>
                    <div class="result-content" id="mjPrompt">${currentData.midjourneyPrompt} --ar 1:1 --v 7</div>
                </div>
            `;
        }
        
        // Midjourneyãƒ—ãƒ­ãƒ³ãƒ—ãƒˆæ›´æ–°
        function updateMjPrompt() {
            if (!currentData) return;
            
            const aspectRatio = document.getElementById('aspectRatio').value;
            const model = document.getElementById('model').value;
            const prompt = `${currentData.midjourneyPrompt} --ar ${aspectRatio} --${model}`;
            
            document.getElementById('mjPrompt').textContent = prompt;
        }
        
        // ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        function copy(type) {
            console.log('Copy function called with type:', type);
            console.log('Current data:', currentData);
            
            if (!currentData) {
                showMessage('âŒ ãƒ‡ãƒ¼ã‚¿ãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                return;
            }
            
            let text = '';
            switch(type) {
                case 'title': 
                    text = currentData.title; 
                    break;
                case 'lyricsJP': 
                    text = currentData.lyricsJP; 
                    break;
                case 'lyricsEN': 
                    text = currentData.lyricsEN; 
                    break;
                case 'stylePrompt': 
                    text = currentData.stylePrompt; 
                    break;
                case 'midjourneyPrompt': 
                    const aspectRatio = document.getElementById('aspectRatio')?.value || '1:1';
                    const model = document.getElementById('model')?.value || 'v 7';
                    text = `${currentData.midjourneyPrompt} --ar ${aspectRatio} --${model}`;
                    break;
                default:
                    showMessage('âŒ ä¸æ˜ãªã‚¿ã‚¤ãƒ—', 'error');
                    return;
            }
            
            if (!text) {
                showMessage('âŒ ã‚³ãƒ”ãƒ¼ã™ã‚‹ãƒ†ã‚­ã‚¹ãƒˆãŒã‚ã‚Šã¾ã›ã‚“', 'error');
                return;
            }
            
            // ã‚³ãƒ”ãƒ¼å‡¦ç†
            if (navigator.clipboard && navigator.clipboard.writeText) {
                navigator.clipboard.writeText(text).then(() => {
                    showMessage('ğŸ“‹ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
                }).catch((err) => {
                    console.error('Clipboard API failed:', err);
                    fallbackCopy(text);
                });
            } else {
                fallbackCopy(text);
            }
        }
        
        // ãƒ•ã‚©ãƒ¼ãƒ«ãƒãƒƒã‚¯ã‚³ãƒ”ãƒ¼æ©Ÿèƒ½
        function fallbackCopy(text) {
            try {
                const textArea = document.createElement('textarea');
                textArea.value = text;
                textArea.style.position = 'fixed';
                textArea.style.opacity = '0';
                document.body.appendChild(textArea);
                textArea.select();
                textArea.setSelectionRange(0, 99999); // ãƒ¢ãƒã‚¤ãƒ«å¯¾å¿œ
                const successful = document.execCommand('copy');
                document.body.removeChild(textArea);
                
                if (successful) {
                    showMessage('ğŸ“‹ ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸ');
                } else {
                    showMessage('âŒ ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
                }
            } catch (err) {
                console.error('Fallback copy failed:', err);
                showMessage('âŒ ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ', 'error');
            }
        }
        
        // ãƒ¡ãƒƒã‚»ãƒ¼ã‚¸è¡¨ç¤º
        function showMessage(text, type = 'success') {
            const message = document.getElementById('message');
            message.textContent = text;
            message.className = 'message show ' + type;
            setTimeout(() => {
                message.classList.remove('show');
            }, 3000);
        }
        
        // åˆæœŸåŒ–
        window.addEventListener('load', () => {
            // ä¿å­˜ã•ã‚ŒãŸAPI Keyã‚’å¾©å…ƒ
            const savedKey = localStorage.getItem('gemini_api_key');
            if (savedKey) {
                document.getElementById('apiKey').value = savedKey;
            }
        });
    </script>
</body>
</html>